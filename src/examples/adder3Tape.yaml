# FIX: 'type' is now a top-level property, outside of the source code block.
name: add binary (3 tape)
type: 3tape

# The 'source code' block now contains everything except the type.
source code: |
  input: '1011+0101'
  blank: ' '

  start state: CopyFirst
  table:
    CopyFirst:
      '0, , ': { write: [' ', '0', ' '], move: ['R', 'R', 'S'], next: CopyFirst }
      '1, , ': { write: [' ', '1', ' '], move: ['R', 'R', 'S'], next: CopyFirst }
      '+, , ': { write: [' ', ' ', ' '], move: ['R', 'S', 'S'], next: CopySecond}

    CopySecond:
      '0, , ': { write: [' ', ' ', '0'], move: ['R', 'S', 'R'], next: CopySecond }
      '1, , ': { write: [' ', ' ', '1'], move: ['R', 'S', 'R'], next: CopySecond }
      ' , , ': { next: Add }

    Add:
      ' ,0,0': { write: ['0', ' ', ' '], move: ['L', 'L', 'L'], next: Add }
      ' ,0,1': { write: ['1', ' ', ' '], move: ['L', 'L', 'L'], next: Add }
      ' ,1,0': { write: ['1', ' ', ' '], move: ['L', 'L', 'L'], next: Add }
      ' ,1,1': { write: ['0', ' ', ' '], move: ['L', 'L', 'L'], next: Carry }
      ' ,0, ': { write: ['0', ' ', ' '], move: ['L', 'L', 'S'], next: Add }
      ' ,1, ': { write: ['1', ' ', ' '], move: ['L', 'L', 'S'], next: Add }
      ' , ,0': { write: ['0', ' ', ' '], move: ['L', 'S', 'L'], next: Add }
      ' , ,1': { write: ['1', ' ', ' '], move: ['L', 'S', 'L'], next: Add }
      ' , , ': { next: accept }

    Carry:
      ' ,0,0': { write: ['1', ' ', ' '], move: ['L', 'L', 'L'], next: Add   }
      ' ,0,1': { write: ['0', ' ', ' '], move: ['L', 'L', 'L'], next: Carry }
      ' ,1,0': { write: ['0', ' ', ' '], move: ['L', 'L', 'L'], next: Carry }
      ' ,1,1': { write: ['1', ' ', ' '], move: ['L', 'L', 'L'], next: Carry }
      ' ,0, ': { write: ['1', ' ', ' '], move: ['L', 'L', 'S'], next: Add   }
      ' ,1, ': { write: ['0', ' ', ' '], move: ['L', 'L', 'S'], next: Carry }
      ' , ,0': { write: ['1', ' ', ' '], move: ['L', 'S', 'L'], next: Add   }
      ' , ,1': { write: ['0', ' ', ' '], move: ['L', 'S', 'L'], next: Carry }
      ' , , ': { write: ['1', ' ', ' '], move: ['S', 'S', 'S'], next: accept}

    accept:

positions:
  CopyFirst: {x: 230, y: 250}
  CopySecond: {x: 400, y: 250}
  Add: {x: 570, y: 250}
  Carry: {x: 740, y: 250}
  accept: {x: 230.01, y: 380}
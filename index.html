<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Turing machine visualization</title>

    <!-- Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.6/lumen/bootstrap.min.css" rel="stylesheet"
    integrity="sha256-QSktus/KATft+5BD6tKvAwzSxP75hHX0SrIjYto471M= sha512-787L1W8XyGQkqtvQigyUGnPxsRudYU2fEunzUP5c59Z3m4pKl1YaBGTcdhfxOfBvqTmJFmb6GDgm0iQRVWOvLQ==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn"t work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Turing machine visualization -->
    <script src='lib/d3.js' charset='utf-8'></script>
    <script src='lib/lodash.js'></script>
    <script>
      var lodash = _;
    </script>
    <script src='lib/lodash.fp.js'></script>
    <script src='lib/js-yaml.min.js' charset='utf-8'></script>
    <script src="https://cdn.jsdelivr.net/es6-promise/3.1.2/es6-promise.min.js"
    crossorigin="anonymous" integrity="sha256-ISoFmwQtUj8LXr8rJvXbSEX2Z76LgRxRa+F6Rh6OMRA="></script>

    <script src='build/TMViz.bundle.js' charset='utf-8'></script>
    <link href='build/StateViz.css' rel='stylesheet' />
    <link href='build/tape/tape.css' rel='stylesheet' />
    <style>
    body {
      font-variant-ligatures: contextual;
    }
    .navbar-brand {
      font-variant: small-caps;
    }
    button.tm-editor-revert {
      position: absolute;
      margin-top: 0;
      margin-left: 4em;
    }
    .btn-wide-save {
      padding-left: 1.5em;
      padding-right:1.5em;
    }
    .tm-editor.ace_editor {
      height: 60em;
      width: 40em;
      border: 1px solid #DDD;
      /*border: 1px solid #ccc;*/
      border-radius: 4px;
      margin: auto;
      margin-top: 1em;
      font-family: 'Source Code Pro', 'source-code-pro', 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
      text-align: left;
    }

    @media print {
      button { visibility: hidden; }
    }

    .checkbox-table tr > :first-child {
      text-align: right
    }
    .checkbox-table tr > :last-child {
      text-align: right;
    }
    .checkbox-table tbody tr, input[type="checkbox"] {
      cursor: pointer;
    }

    a.disclosure-triangle {
      cursor: pointer;
      text-decoration: none;
    }
    a.disclosure-triangle + div.collapse ,
    a.disclosure-triangle + div.collapsing {
      margin-top: 1em;
    }
    a.disclosure-triangle:before {
      content: '▸';
      transform: rotate(90deg);
      transform-origin: center;
      transition: transform 0.1s linear;
      display: inline-block;
      font-size: larger;
      margin-right: 0.2em;
    }
    a.disclosure-triangle.collapsed:before {
      transform: none;
    }
    .modal-dialog td pre {
      white-space: pre-wrap;
      font-size: smaller;
    }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <div class="navbar-header">
          <span class="navbar-brand">Turing Machine Visualization</span>
        </div>

        <div class="navbar-form navbar-left">
          <!-- Document Menu -->
          <select id="tm-doc-menu" class="form-control"></select>
          <!-- Edit Menu -->
          <div class="btn-group">
            <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Edit <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a href="#" id="tm-doc-action-duplicate">Duplicate document</a></li>
              <li><a href="#" id="tm-doc-action-newblank">New blank document</a></li>
              <li role="separator" class="divider"></li>
              <!-- "Rename" saves when closed, so don't allow closing with Esc -->
              <li><a href="#" data-toggle="modal" data-keyboard="false"
                data-target="#renameDialog">Rename&hellip;</a></li>
              <li role="separator" class="divider"></li>
              <li><a href="#" data-toggle="modal" data-target="#deleteDialog">Delete&hellip;</a></li>
            </ul>
          </div>
        </div>
        <!-- "Share" Menu -->
        <!-- <button type="button" class="btn btn-default navbar-btn navbar-right" aria-label="Share">
          <span class="glyphicon glyphicon-share" aria-hidden="true"></span>
        </button> -->
        <div class="navbar-right"
        data-toggle="tooltip" data-placement="left" data-trigger="hover" title="Share">
          <button type="button" class="btn btn-default navbar-btn" aria-label="Share"
          data-toggle="modal" data-target="#sharingDialog">
            <span class="glyphicon glyphicon-share" aria-hidden="true"></span>
          </button>
        </div>
      </div>
    </nav>
    <!-- Dialog for Rename -->
    <div id="renameDialog" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="renameDialogHeader">
      <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="renameDialogHeader">Rename</h4>
          </div>
          <div class="modal-body">
            <form id="renameDialogForm">
              <label class="sr-only" for="renameDialogName">Document Name</label>
              <input type="text" class="form-control" id="renameDialogName" placeholder="document name">
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Dialog for Delete -->
    <div id="deleteDialog" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="deleteDialogHeader">
      <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="deleteDialogHeader">Delete this document?</h4>
          </div>
          <div class="modal-body">
            This will erase the document and remove it from the menu.
            You can’t undo this action.
          </div>
          <div class="modal-footer">
            <button id="tm-doc-action-delete" type="button"
              class="btn btn-danger pull-left" data-dismiss="modal">Delete</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Dialog for Resetting an Example -->
    <div id="resetExampleDialog" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="resetExampleDialogHeader">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="resetExampleDialogHeader">Save a copy of your changes?</h4>
          </div>
          <div class="modal-body">
            <p>Resetting this example will erase any changes.</p>
            You can save your changes into a duplicate document, or simply discard them.
            You can’t undo this action.
          </div>
          <div class="modal-footer">
            <button id="tm-doc-action-resetdiscard" type="button"
              class="btn btn-danger pull-left" data-dismiss="modal">Discard</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
            <button id="tm-doc-action-resetsave" type="button"
              class="btn btn-primary btn-wide-save" data-dismiss="modal">Save</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Dialog for Sharing/Export -->
    <div id="sharingDialog" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="sharingDialogHeader">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="sharingDialogHeader">Share &amp; Export</h4>
          </div>
          <div class="modal-body">
            <p>
              Downloading a document lets you keep a backup and import it on other browsers and devices.
              To import a document, simply drag and drop the file here or anywhere on the page.
            </p>
            <!-- XXX: notify about unloaded changes -->
          </div>
          <!-- <div class="modal-footer">
          </div> -->
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-7 form-group text-center">
          <!-- Diagram -->
          <div id="machine-container">
            <!-- Noscript notice -->
            <noscript>
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h3 class="panel-title">Tip: Enable JavaScript</h3>
                </div>
                <div class="panel-body">
                  <p>The visualization couldn't load because JavaScript is disabled.</p>
                </div>
              </div>
            </noscript>
          </div>
          <!-- Simulator controls -->
          <div id="controls-container" class="row text-center">
            <div class="col-xs-1">
              <button type="button" class="btn btn-warning btn-xs text-center tm-btn-diagram tm-reset">
                <span class="glyphicon glyphicon-fast-backward" aria-hidden="true"></span><br>
                Reset
              </button>
            </div>
            <div class="col-xs-2 col-xs-offset-4 text-center">
              <button type="button" class="btn btn-primary text-center tm-btn-diagram tm-step">
                <span class="glyphicon glyphicon-step-forward" aria-hidden="true"></span><br>
                Step
              </button>
            </div>
            <div class="col-xs-1">
              <button type="button" class="btn btn-default text-center tm-btn-diagram tm-run">
                <span class="glyphicon glyphicon-play" aria-hidden="true"></span><br>
                Run
              </button>
            </div>
          </div>
        </div>

        <!-- Code Editor -->
        <div class="col-md-5 form-group text-center">
          <div id="editor-alerts-container"></div>
          <button type="button" class="btn btn-primary tm-editor-load">
            Load machine
          </button>
          <button type="button" class="btn btn-default tm-editor-revert">
            Revert to diagram
          </button>
          <div id="editor-container" class="tm-editor"></div>
        </div>
      </div>

      <!-- jQuery (necessary for Bootstrap plugins) -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
      <script>
        $(function () {
          $('[data-toggle="tooltip"]').tooltip()
        })
      </script>
      <!-- Entry point -->
      <script src='lib/ace-builds/src-min-noconflict/ace.js' charset='utf-8'></script>
      <script src='build/main.bundle.js' charset='utf-8'></script>
    <hr>
    <!-- Tutorial -->
    <div class="row">
      <div class="col-md-4 col-sm-6">
        <h3>Try it out</h3>
        <p>Pick an example from the menu, and run or step through it to see what it does.</p>

        Run or step through an example to see what it does.
        See if you can discern what each state means and how it relates to the other states.
        <br>
        Feel free to drag nodes around, comment lines out, and experiment.
        Changes are autosaved, and you can reset an example back to its default at any time.
        Changes are autosaved, and when you want an example back to how it started, you can reset it to the default.
        Changes are automatically saved, and in case an example gets messed up beyond recognition, you can reset it back to the default.
        <!-- the built-in examples can be reset to defaults. -->
        <p>
          Try your hand at the exercises included in some of the examples.
          You can keep your work safe before a major change by making a duplicate document.
        </p>
      </div>

      <div class="col-md-4 col-sm-6">
        <h3>Make your own</h3>
        Make spinoffs from the examples or your own creations by choosing Edit > Duplicate document.
        You can also start from scratch with "New blank document".

        <h4>Example</h4>
<pre>
# binary increment
input: '1011'
blank: ' '
start state: right
table:
  # scan to the right end
  right:
    1  : R
    0  : R
    ' ': {L: inc}
  # then carry the 1
  inc:
    1  : {write: 0, L}
    0  : {write: 1, R: done}
    ' ': {write: 1, R: done}
  done:
</pre>
      </div>

      <div class="col-md-4 col-sm-6">
        <!-- <h3>Tips</h3> -->
        <!-- XXX: not a verbal phrase -->
        <h3>Tips</h3>
        <h4>Arrange the diagram</h4>
        <p> <b>Drag</b> or click a state node to fix it in place. </p>
        <p> <b>Double-click</b> a node to release it. </p>
        <h4>Edit with keyboard shortcuts</h4>
        <style media="screen">
          .editor-shortcuts td:first-child {
            text-align: right;
          }
        </style>
        <table class="editor-shortcuts table">
          <tbody>
            <tr>
              <td><kbd>Cmd</kbd>-<kbd>/</kbd></td>
              <td>Toggle comment</td>
            </tr>
            <tr>
              <td><kbd>Tab</kbd></td>
              <td>Indent selection</td>
            </tr>
            <tr>
              <td><kbd>Shift</kbd>-<kbd>Tab</kbd></td>
              <td>Unindent selection</td>
            </tr>
            <tr>
              <td><kbd>Opt</kbd>-<kbd>↑</kbd></td>
              <td>Move line up</td>
            </tr>
            <tr>
              <td><kbd>Opt</kbd>-<kbd>↓</kbd></td>
              <td>Move line down</td>
            </tr>
            <tr>
              <td><kbd>Ctrl</kbd>-<kbd>Opt</kbd>-<kbd>→</kbd></td>
              <td>Add next occurrence to selection<br>
              <small>Like a quick "find". Useful for renaming things.</small></td>
            </tr>
            <tr>
              <td><kbd>Cmd</kbd>-<kbd>F</kbd></td>
              <td>Find</td>
            </tr>
            <tr>
              <td><kbd>Cmd</kbd>-<kbd>Opt</kbd>-<kbd>F</kbd></td>
              <td>Find and Replace</td>
            </tr>
          </tbody>
        </table>
        More keyboard shortcuts are available on the
        <a href="https://github.com/ajaxorg/ace/wiki/Default-Keyboard-Shortcuts"
        target="_blank">full list</a>.
      </div>
    </div>
    <hr>
    <!-- XXX: old reference -->
      <div class="row">
        <div class="col-md-4 col-sm-6">
          <h3>Format</h3>
          <p>
            <!-- <p>
              At each step, a Turing machine looks up and carries out the <a href="#def-transition">transition</a>
              for combination of its current state and the current symbol under the tape head.
            </p> -->
            <p>
              At each step, a Turing machine takes its current state and current symbol under the tape head,
              looks it up in its transition table, and carries out the resulting instruction.
            </p>
            <h4>Example</h4>
<pre>
# binary increment
input: '1011'
blank: ' '
start state: right
table:
  # scan to the right end
  right:
    1  : R
    0  : R
    ' ': {L: inc}
  # then carry the 1
  inc:
    1  : {write: 0, L}
    0  : {write: 1, R: done}
    ' ': {write: 1, R: done}
  done:
</pre>
          <h4>Additional Info</h4>
          The document format is <a href="https://en.wikipedia.org/wiki/YAML" target="_blank">YAML</abbr></a>.
          <!-- <h4>N.B.</h4>
          Numbers on the right side of a mapping (key: value) are automatically converted to strings, so
          00101 becomes 101. To keep the leading zeros, use quotes: '00101' or "00101".
          </p> -->
        </div>
        <div class="col-md-4 col-sm-6">
          <h3>Instruction Format</h3>
          <p>
            Each <dfn id="def-tm-instruction">instruction</dfn> has three steps:
            <ol>
              <li>write a symbol to the tape</li>
              <li>move the tape head left (<code>L</code>) or right (<code>R</code>)</li>
              <li>set the new state</li>
            </ol>
            <!-- then moves the tape head left (<code>L</code>) or right (<code>R</code>),
            and finally sets the new state. -->
          </p>
          <p> <code>{write: <i>symbol</i>, <i>move</i>: <i>state</i>}</code> </p>
          <p>For convenience and simplicity, you can omit any parts that aren't changed.</p>
          <p>
            <strong>TODO: write several different drafts and compare</strong>
          </p>
          <p>
            <code>{<i>move</i>: <i>state</i>}</code> moves the tape head and goes to another state.
            It writes back the same symbol that was read.
          </p>
          <p>
            <code>L</code> or <code>R</code> only moves the tape head,
            since it writes back the same symbol and stays in the same state.
          </p>
        </div>
        <div class="col-md-3 col-sm-11">
          <h3>Diagram</h3>
          <p> <b>Drag</b> or click a state node to fix it in place. </p>
          <p> <b>Double-click</b> a node to release it. </p>
        </div>
        <div class="col-sm-1">
          GitHub link here.
        </div>
      </div>
      <hr>
      <div class="row">
        <div class="col-sm-6">
          <div class="form-group">
            <label for="importBox">Import Document</label>
            <textarea id="importBox" class="form-control" rows="30" cols="60"
            placeholder="Copy &amp; paste the document here."></textarea>
          </div>
          <button id="importButton" class="btn btn-default" type="button" name="button">Import</button>
        </div>
      </div>
    </div>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <!-- Dialog for Import -->
    <div id="importDialog" class="modal fade" tabindex="-1" role="dialog"
    aria-labelledby="importDialogHeader">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="importDialogHeader">Import</h4>
          </div>
          <div class="modal-body">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
